import * as React from 'react';
import * as classNames from 'classnames';
import * as PT from 'prop-types';
import { Checkbox } from './';

import 'nav-frontend-skjema-style';
import SkjemaelementFeilmelding, {
    SkjemaelementFeil,
    skjemaelementFeilmeldingShape }
from './skjemaelement-feilmelding';

export interface BekreftCheckboksPanelProps {
    /**
     * Callback-funksjon som blir kalt når checkboksen endrer state
     */
    onChange: (event: React.SyntheticEvent<EventTarget>) => void;
    /**
     * Default checked state for checkboksen
     */
    checked: boolean;
    /**
     * Tekst til høyre for checkboksen
     */
    label: string;
    /**
     * Tekst over checkboksen
     */
    children?: React.ReactNode | React.ReactChildren;
    /**
     * Øvrige custom props til <input>-elementet som ligger i bunn
     */
    inputProps?: React.InputHTMLAttributes<HTMLInputElement>;
    /**
     * Klassenavn
     */
    className?: string;
    /**
     * Feilmelding
     */
    feil?: SkjemaelementFeil;
}

export class BekreftCheckboksPanel extends React.Component<BekreftCheckboksPanelProps> {
    render() {
        const { checked, onChange, label, inputProps, className, feil } = this.props;
        const hasError: boolean = typeof feil !== 'undefined' && feil !== null && !!feil.feilmelding;

        const cls = classNames('bekreftCheckboksPanel', className, {
            'bekreftCheckboksPanel--checked': checked,
            'bekreftCheckboksPanel--error': hasError
        });

        return (
            <div className={cls}>
                {
                    this.props.children &&
                    <div className="bekreftCheckboksPanel__innhold">{this.props.children}</div>
                }
                <Checkbox
                    {...inputProps}
                    label={label}
                    checked={checked}
                    aria-checked={checked}
                    onChange={onChange}
                />
                {hasError && (
	                <SkjemaelementFeilmelding feil={feil} />
                )}
            </div>
        );
    }
}

(BekreftCheckboksPanel as React.ComponentClass).propTypes = {
    children: PT.node,
    className: PT.string,
    checked: PT.bool.isRequired,
    label: PT.string.isRequired,
    onChange: PT.func.isRequired,
    feil: skjemaelementFeilmeldingShape
};

export default BekreftCheckboksPanel;
